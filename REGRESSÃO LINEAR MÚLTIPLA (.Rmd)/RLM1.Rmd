---
output: html_document
---
#REGRESSÃO LINEAR MÚLTIPLA
```{r, include=FALSE}
library("mime")
library("stringi")
library("magrittr") 
library("Rcpp")
library("evaluate")
library("digest")
library("formatR")
library("highr")
library("markdown")
library("stringr")
library("yaml")
library("bitops")
library("caTools")
library("htmltools")
library("knitr")
library("rmarkdown")
library("e1071")
library("fBasics")
library("DAAG")
library("MASS")
library("fdth")
library("dplyr")
library("moments")
library("qcc")
library("rafalib")
library("reshape2")
library("survey")
library("raster")
library("knitr")
```

##QUESTÃO RLM1
Acredita-se que a vazão de vapor (em ton/h) usada mensalmente por uma planta
química está relacionada com a temperatura ambiente (em ºF) daquele mês. Os usos e temperaturas dos últimos anos estão mostradas na tabela que segue:

```{r, echo=FALSE}
setwd(paste(getwd(),"/DBRLM",sep=""))
LQRLM1 <- read.table(file = "LQRLM1.txt",
                    header = TRUE)
knitr::kable(LQRLM1, align = 'c')
setwd("../")
```

a) Assuma que o modelo de regressão linear simples é apropriado e ajuste o modelo de regressão relacionando a vazão de vapor (y) e a temperatura (x).

b) Avalie a significância do modelo de regressão.

c) Analise o significado de cada p-valor (P) apresentado ao lado fazendo-se uso do teste de hipóteses. Você faria alguma sugestão de alteração do seu modelo de regressão?

###Resposta letra a)
*Utiliza-se a função **lm()** para realizar a regressão linear.*
```{r}
modelo.RLM1.1 <- lm(Vazao ~ Temp, data = LQRLM1)
summary(modelo.RLM1.1)

confint(modelo.RLM1.1)

anova(modelo.RLM1.1)

plot(modelo.RLM1.1$fitted.values, LQRLM1$Vazao,
     main = "Ajuste para o Modelo 1",
     ylab = "Vazão experimental",
     xlab = "Vazão Ajustada")
abline(a = 0, b = 1, lty = 2, col = "red")
```

###Resposta letra b)
```{r}
par(mfrow = c(1, 2))
plot(x = LQRLM1$Vazao, y = modelo.RLM1.1$residuals,
     main = "Vazão X Resíduos",
     ylab = "Vazão experimental",
     xlab = "Resíduos",
     pch = 16,
     col = "blue")
plot(x = LQRLM1$Temp, y = modelo.RLM1.1$residuals,
     main = "Temperatura X Resíduos",
     ylab = "Temperatura experimental",
     xlab = "Resíduos",
     pch = 16,
     col = "red")

par(mfrow = c(1, 2))
hist(x = modelo.RLM1.1$residuals,
     main = "",
     ylab = "Frequência",
     xlab = "Resíduos",
     col = "lightgreen")
boxplot(x = modelo.RLM1.1$residuals)

shapiro.test(modelo.RLM1.1$residuals)
```

O modelo linear apresenta dois coeficientes de regressão: o coeficiente angular (Estimate/Temp); e o coeficiente linear (Estimate /Intercept). Utilizando a função lm() é possível construir o modelo linear da Vazão de Vapor (ton/h) em função da Temperatura (ºF). A função summary() é utilizada para mostrar os parâmetros do modelo.

Realizou-se a validação do modelo linear através através da avaliação da hipótese de aleatoriedade e normalidade dos resíduos do modelo linear de forma gráfica. Apesar da presença de um outlier, os resíduos se mostraram aleatórios e normalmente distribuidos. Através do teste Shapiro, constatou-se que a presença do outlier descaracteriza a distribuição dos resíduos como sendo normal, sendo rejeitada a hipotese de normalidade dos resíduos. A validação do modelo demonstrou até certo ponto que as considerações necessárias para o método dos mínimos quadrados não foram atendidos. Recomenda-se uma avaliação para a exclusão do outlier, construção e validação de um novo modelo linear.

O modelo demonstra-se estatisticamente significativo devido a rejeição da hipótese nula na qual o coeficiente angular (Estimate/Temp) seria zero. A hipótese nula é rejeitada devido à significância da análise da variância (ANOVA), que apresentou p-valor inferior a 0,05.

###Resposta letra c)
É possível utilizar os p-valores obtidos para avaliar a significância dos parâmetros do modelo linear. Nota-se que a utilização da variável temperatura no modelo linear proposto é estatisticamente significativa, sendo o p-valor inferior ao nível de significância de 0,05. Já o coeficiente linear mostrou-se não significante (falhou em rejeitar a hipótese nula) com um p-valor superior a 0,05. Observa-se que o teste para a variância ANOVA mostrou-se coerente com o teste T. A sugestão para o novo modelo linear seria a retirada do coeficiente angular conforme código abaixo:

```{r}
modelo.RLM1.2 <- lm(Vazao ~ -1 + Temp, data = LQRLM1)
summary(modelo.RLM1.2)

confint(modelo.RLM1.2)
anova(modelo.RLM1.2)

plot(modelo.RLM1.2$fitted.values, LQRLM1$Vazao,
     main = "Ajuste para o Modelo 2",
     ylab = "Vazão experimental",
     xlab = "Vazão Ajustada")
abline(a = 0, b = 1, lty = 2, col = "red")
```